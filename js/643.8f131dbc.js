"use strict";(self["webpackChunkshoppinglistmanager"]=self["webpackChunkshoppinglistmanager"]||[]).push([[643],{7643:function(e,a,l){l.r(a),l.d(a,{default:function(){return U}});var t=l(6252),i=l(3577);const o=(0,t.Uk)("mdi-arrow-left"),n=(0,t.Uk)(" Back "),s=(0,t._)("div",null,"Image:",-1),u=["src"],r=(0,t.Uk)("mdi-camera"),c=(0,t.Uk)(" Take Picture "),d=(0,t._)("div",null,"Id:",-1),m=(0,t._)("div",null,"Name:",-1),v=(0,t._)("div",null,"Description:",-1);function f(e,a,l,f,g,p){const w=(0,t.up)("v-icon"),b=(0,t.up)("v-btn"),k=(0,t.up)("v-col"),_=(0,t.up)("v-row"),h=(0,t.up)("v-container"),C=(0,t.up)("camera-dialog");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(b,{onClick:a[0]||(a[0]=a=>e.$router.go(-1))},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[o])),_:1}),n])),_:1}),(0,t.Wm)(h,{fluid:""},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{cols:"3"},{default:(0,t.w5)((()=>[s])),_:1}),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(_,{"no-gutters":""},{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t._)("img",{src:e.state.basket?.image},null,8,u)])),_:1})])),_:1}),(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t.Wm)(b,{onClick:e.openCamera,size:"x-small"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[r])),_:1}),c])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{cols:"3"},{default:(0,t.w5)((()=>[d])),_:1}),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t._)("div",null,(0,i.zw)(e.basketId),1)])),_:1})])),_:1}),(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{cols:"3"},{default:(0,t.w5)((()=>[m])),_:1}),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t._)("div",null,(0,i.zw)(e.state.basket?.name),1)])),_:1})])),_:1}),(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[(0,t.Wm)(k,{cols:"3"},{default:(0,t.w5)((()=>[v])),_:1}),(0,t.Wm)(k,null,{default:(0,t.w5)((()=>[(0,t._)("div",null,(0,i.zw)(e.state.basket?.description),1)])),_:1})])),_:1})])),_:1}),(0,t.Wm)(C,{basketId:Number(e.basketId),cameraVisible:e.state.cameraVisible,onCloseCamera:e.closeCamera},null,8,["basketId","cameraVisible","onCloseCamera"])],64)}var g=l(2262);const p={ref:"videoRef",width:"320",style:{border:"3px dashed white"}},w=["width","height"];function b(e,a,l,i,o,n){const s=(0,t.up)("v-btn"),u=(0,t.up)("v-card-actions"),r=(0,t.up)("v-sheet"),c=(0,t.up)("v-divider"),d=(0,t.up)("v-card-text"),m=(0,t.up)("v-container"),v=(0,t.up)("v-card"),f=(0,t.up)("v-dialog");return(0,t.wg)(),(0,t.j4)(f,{modelValue:e.state.cameraVisible,"onUpdate:modelValue":a[0]||(a[0]=a=>e.state.cameraVisible=a),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"mdi-close",size:"x-small",onClick:e.closeCamera},null,8,["onClick"])])),_:1}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t._)("video",p,"Video stream not available.",512)])),_:1}),(0,t.Wm)(c),(0,t.Wm)(r,null,{default:(0,t.w5)((()=>[(0,t._)("canvas",{ref:"canvasRef",width:e.width,height:e.height,style:{display:"none"}},null,8,w)])),_:1})])),_:1}),(0,t.Wm)(c),(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,{align:"center"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{color:"primary",icon:"mdi-camera",onClick:e.takePicture},null,8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,t.Wm)(c)])),_:1},8,["modelValue"])}var k=l(3907),_=l(9905),h=(0,t.aZ)({name:"CameraDialog",props:{cameraVisible:Boolean,basketId:Number},setup(e,{emit:a}){const l=(0,k.oR)(),i=(0,g.iH)(null),o=(0,g.iH)(null),n=320;let s=0,u=!1;const r=(0,g.qj)({cameraVisible:e.cameraVisible});(0,t.ic)((()=>{r.cameraVisible=e.cameraVisible,r.cameraVisible&&d(i.value,o.value)}));const c=()=>{if(null!==o.value&&null!==i.value){if(console.log("CameraDialog.takePicture: take a picture of the currently displayed video stream"),console.log("takePicture1 "+n+", "+s),n&&s){console.log("takePicture2 "+n+", "+s),o.value.width=n,o.value.height=s;const a=o.value.getContext("2d");if(null!==a&&(a.drawImage(i.value,0,0,n,s),e.basketId)){let a=o.value.toDataURL("image/png");l.dispatch(_.U.StoreBasketImage,{basketId:e.basketId.valueOf(),imageDataUrl:a})}}v()}else console.log("CameraDialog.takePicture: canvas, video or photo is null")},d=(e,a)=>{null!==e&&null!==a?(console.log("CameraDialog.startVideoCamera: Start video camera"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(a){null!==e&&(e.srcObject=a,e.play())})).catch((function(e){console.log("Could not access user camera: no compatible camera found or access denied. "+e)})),e.addEventListener("canplay",(function(){u||(s=e.videoHeight/(e.videoWidth/n),e.setAttribute("width",String(n)),e.setAttribute("height",String(s)),a.setAttribute("width",String(n)),a.setAttribute("height",String(s)),u=!0)}),!1)):console.log("CameraDialog.startVideoCamera: canvas or video is null")},m=e=>{if(console.log("CameraDialog.stopVideoCamera: Stop video camera"),null!==e){let a=e.srcObject;a.getTracks().forEach((e=>{e.stop()}))}},v=()=>{console.log("CameraDialog.closeCamera"),m(i.value),a("close-camera")};return{state:r,canvasRef:o,videoRef:i,width:n,height:s,takePicture:c,startVideoCamera:d,stopVideoCamera:m,closeCamera:v}}}),C=l(3744);const W=(0,C.Z)(h,[["render",b]]);var V=W,I=(0,t.aZ)({name:"BasketView",components:{CameraDialog:V},props:{basketId:String},setup(e){const a=(0,k.oR)(),l=(0,g.qj)({basket:(0,t.Fl)((()=>a.state.baskets.find((a=>a.id==e.basketId)))),cameraVisible:!1}),i=()=>{console.log("BasketView.openCamera"),l.cameraVisible=!0},o=()=>{l.cameraVisible=!1};return{store:a,state:l,openCamera:i,closeCamera:o}}});const D=(0,C.Z)(I,[["render",f]]);var U=D}}]);
//# sourceMappingURL=643.8f131dbc.js.map